import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { useState, useEffect } from "react";
import {} from "@/lib/localStorage";
import { RoleAwareHeader } from "./RoleAwareHeader";
import { Card, CardContent, CardHeader, CardTitle } from "./ui/card";
import { Button } from "./ui/button";
import { ArrowLeft, Wallet, TrendingUp, DollarSign, Calendar } from "lucide-react";
import { AreaChart, Area, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, BarChart, Bar } from "recharts";
export function EarningsPage({ user, onNavigate, onLogout }) {
    const [period, setPeriod] = useState('weekly');
    const [data, setData] = useState([]);
    const [summary, setSummary] = useState({ today: 0, yesterday: 0, thisWeek: 0, total: 0 });
    const [loading, setLoading] = useState(true);
    useEffect(() => {
        const fetchData = async () => {
            setLoading(true);
            try {
                // Fetch mock earnings from backend
                const res = await fetch(`http://localhost:3001/api/guides/${user.id}/earnings?period=${period}`);
                const json = await res.json();
                setData(json.graph);
                setSummary(json.summary);
            }
            catch (error) {
                console.error("Failed to fetch earnings", error);
            }
            finally {
                setLoading(false);
            }
        };
        fetchData();
    }, [user.id, period]);
    return (_jsxs("div", { className: "min-h-screen bg-gray-50", children: [_jsx(RoleAwareHeader, { user: user, currentPage: "calendar" // highlight nothing specific or calendar
                , onNavigate: onNavigate, onLogout: onLogout }), _jsxs("main", { className: "container mx-auto px-4 py-8 max-w-5xl", children: [_jsxs(Button, { variant: "ghost", size: "sm", onClick: () => onNavigate('home'), className: "mb-6 text-gray-600 hover:text-gray-900", children: [_jsx(ArrowLeft, { className: "w-4 h-4 mr-1" }), " Back to Dashboard"] }), _jsxs("div", { className: "flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8", children: [_jsxs("div", { children: [_jsx("h2", { className: "text-3xl font-bold text-gray-900 tracking-tight", children: "Earnings & Analytics" }), _jsx("p", { className: "text-gray-500 mt-1", children: "Track your revenue and financial growth." })] }), _jsx("div", { className: "flex bg-white rounded-lg p-1 shadow-sm border border-gray-200", children: ['daily', 'weekly', 'monthly'].map((p) => (_jsx("button", { onClick: () => setPeriod(p), className: `px-4 py-2 text-sm font-medium rounded-md transition-all ${period === p
                                        ? 'bg-primary text-white shadow-sm'
                                        : 'text-gray-600 hover:bg-gray-50'} capitalize`, children: p }, p))) })] }), _jsxs("div", { className: "grid grid-cols-1 md:grid-cols-3 gap-6 mb-8", children: [_jsx(Card, { className: "bg-gradient-to-br from-green-500 to-green-600 border-none text-white shadow-lg", children: _jsxs(CardContent, { className: "p-6", children: [_jsxs("div", { className: "flex justify-between items-start", children: [_jsxs("div", { children: [_jsx("p", { className: "text-green-100 font-medium text-sm", children: "Total Earnings" }), _jsxs("h3", { className: "text-4xl font-bold mt-2", children: ["\u20B9", summary.total.toLocaleString()] })] }), _jsx("div", { className: "p-3 bg-white/20 rounded-xl backdrop-blur-sm", children: _jsx(Wallet, { className: "w-6 h-6 text-white" }) })] }), _jsxs("div", { className: "mt-4 flex items-center gap-2 text-green-100 text-sm", children: [_jsx(TrendingUp, { className: "w-4 h-4" }), _jsx("span", { children: "+12% vs last month" })] })] }) }), _jsx(Card, { children: _jsxs(CardContent, { className: "p-6", children: [_jsxs("div", { className: "flex justify-between items-start", children: [_jsxs("div", { children: [_jsx("p", { className: "text-gray-500 font-medium text-sm", children: "Today's Revenue" }), _jsxs("h3", { className: "text-3xl font-bold mt-2 text-gray-900", children: ["\u20B9", summary.today.toLocaleString()] })] }), _jsx("div", { className: "p-3 bg-blue-50 rounded-xl", children: _jsx(DollarSign, { className: "w-6 h-6 text-blue-600" }) })] }), _jsx("div", { className: "mt-4 flex items-center gap-2 text-gray-500 text-sm", children: _jsxs("span", { children: ["Yesterday: ", _jsxs("span", { className: "font-semibold", children: ["\u20B9", summary.yesterday.toLocaleString()] })] }) })] }) }), _jsx(Card, { children: _jsxs(CardContent, { className: "p-6", children: [_jsxs("div", { className: "flex justify-between items-start", children: [_jsxs("div", { children: [_jsx("p", { className: "text-gray-500 font-medium text-sm", children: "This Week" }), _jsxs("h3", { className: "text-3xl font-bold mt-2 text-gray-900", children: ["\u20B9", summary.thisWeek.toLocaleString()] })] }), _jsx("div", { className: "p-3 bg-purple-50 rounded-xl", children: _jsx(Calendar, { className: "w-6 h-6 text-purple-600" }) })] }), _jsx("div", { className: "mt-4 flex items-center gap-2 text-gray-500 text-sm", children: _jsxs("span", { className: "text-green-600 font-medium flex items-center gap-1", children: [_jsx(TrendingUp, { className: "w-3 h-3" }), " On track"] }) })] }) })] }), _jsxs(Card, { className: "border-none shadow-md", children: [_jsx(CardHeader, { children: _jsx(CardTitle, { children: "Revenue Trends" }) }), _jsx(CardContent, { className: "pl-0", children: _jsx("div", { className: "h-[400px] w-full", children: loading ? (_jsx("div", { className: "h-full w-full flex items-center justify-center", children: _jsx("div", { className: "animate-spin rounded-full h-8 w-8 border-b-2 border-primary" }) })) : (_jsx(ResponsiveContainer, { width: "100%", height: "100%", children: period === 'monthly' ? (_jsxs(BarChart, { data: data, margin: { top: 10, right: 30, left: 0, bottom: 0 }, children: [_jsx(CartesianGrid, { strokeDasharray: "3 3", vertical: false, stroke: "#E5E7EB" }), _jsx(XAxis, { dataKey: "name", axisLine: false, tickLine: false, tick: { fill: '#6B7280', fontSize: 12 }, dy: 10 }), _jsx(YAxis, { axisLine: false, tickLine: false, tick: { fill: '#6B7280', fontSize: 12 }, tickFormatter: (value) => `₹${value / 1000}k` }), _jsx(Tooltip, { contentStyle: { borderRadius: '8px', border: 'none', boxShadow: '0 4px 6px -1px rgb(0 0 0 / 0.1)' }, formatter: (value) => [`₹${value.toLocaleString()}`, 'Revenue'] }), _jsx(Bar, { dataKey: "value", fill: "#4F46E5", radius: [4, 4, 0, 0], barSize: 50 })] })) : (_jsxs(AreaChart, { data: data, margin: { top: 10, right: 30, left: 0, bottom: 0 }, children: [_jsx("defs", { children: _jsxs("linearGradient", { id: "colorValue", x1: "0", y1: "0", x2: "0", y2: "1", children: [_jsx("stop", { offset: "5%", stopColor: "#4F46E5", stopOpacity: 0.3 }), _jsx("stop", { offset: "95%", stopColor: "#4F46E5", stopOpacity: 0 })] }) }), _jsx(CartesianGrid, { strokeDasharray: "3 3", vertical: false, stroke: "#E5E7EB" }), _jsx(XAxis, { dataKey: "name", axisLine: false, tickLine: false, tick: { fill: '#6B7280', fontSize: 12 }, dy: 10 }), _jsx(YAxis, { axisLine: false, tickLine: false, tick: { fill: '#6B7280', fontSize: 12 }, tickFormatter: (value) => `₹${value}` }), _jsx(Tooltip, { contentStyle: { borderRadius: '8px', border: 'none', boxShadow: '0 4px 6px -1px rgb(0 0 0 / 0.1)' }, formatter: (value) => [`₹${value.toLocaleString()}`, 'Revenue'] }), _jsx(Area, { type: "monotone", dataKey: "value", stroke: "#4F46E5", strokeWidth: 3, fillOpacity: 1, fill: "url(#colorValue)" })] })) })) }) })] })] })] }));
}
